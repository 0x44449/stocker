# 뉴스량 이상 감지 API

## 목적

특정 종목의 뉴스 멘션이 평소 대비 급증하면 이상 신호로 감지하여 피드 카드로 보여주고 싶다.
"LG화학 뉴스량 급증, 5일 평균 대비 3.2배" 같은 정보를 제공한다.

## 결정사항

### 이상 감지 로직

- 오늘 멘션 수: 어제 현재시각 ~ 지금 (최근 24시간)
- 과거 평균: D-2 ~ D-6 하루 전체, 5일 평균
- 이상 신호 조건: 오늘 멘션 ≥ 10건 AND 5일 평균 대비 2배 이상
- 최소 멘션 10건 = 프로바이더 수(4) × 2.5, 프로바이더 수는 하드코딩
- 비교 기간 5일, 임계값 2배 모두 하드코딩

### 구현 방식

- extraction의 keywords를 직접 쿼리하여 집계 (별도 집계 테이블 없음)
- stock_master, stock_alias, subsidiary_mapping으로 키워드 → 종목 정규화
- Python에서 처리, Spring이 API 중개

### 응답 필드

- stock_code, stock_name
- today_count: 오늘(최근 24시간) 멘션 수
- avg_count: 5일 평균 멘션 수
- ratio: 오늘 / 평균 비율

## 안 할 것

- 집계 테이블 (stock_mention 등) 생성
- 급증 이유 요약 (클러스터링 topic 연동은 별도 작업)
- 장중 지연 주가 데이터 연동
- 프로바이더 수 설정 외부화
